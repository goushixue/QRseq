[["index.html", "QRAP: an R package and Shiny app for interactive RNA sequencing data analysis Preface", " QRAP: an R package and Shiny app for interactive RNA sequencing data analysis Shixue Gou 2022-12-29 Preface "],["intro.html", "Chapter 1 Introduction 1.1 Introduction 1.2 Installation 1.3 Get started", " Chapter 1 Introduction 1.1 Introduction Motivation: RNA-sequencing (RNA-seq) has become the most commonly used tool in life science research for exploring whole transcript profiles. The advancement of next-generation sequencing has promoted a large amount of RNA-seq data. However, the popularity of bioinformatics lags far behind the generation of sequencing data, resulting in the inability of most researchers to analyze RNA-seq data. Although a large number of tools are currently available for RNA-seq analysis, data uploading, analysis, and visualization through an interactive interface are more acceptable to researchers than command-line codes. Results: We designed an interactive RNA-seq analysis toolkit based on the R Shiny package, named QRAP (Quick RNA-seq Analysis Platform), which can easily accomplish RNA-seq data analysis and visualization through a user-friendly interface on the web page. As a comprehensive RNA-seq analysis tool, QRAP can support the analysis of publicly available and user-generated data, which include regular RNA-seq data, time-course RNA-seq data, and clinically relevant RNA-seq data, and provide functional annotation for approximately 500 species. Availability and implementation: As an open source R package, QRAP can be freely accessed at https://github.com/gsx-ucas/QRAP. 1.2 Installation 1.2.1 R package To install QRAP, R version 4.0 or greater is required. We also recommend installing R Studio. 1.2.1.1 Install the release version of QRAP # Enter commands in R (or R studio, if installed) # Install the remotes package install.packages(&#39;devtools&#39;) devtools::install_github(&quot;gsx-ucas/QRAP&quot;) 1.2.1.2 Install the development version of QRAP # Enter commands in R (or R studio, if installed) # Install the remotes package install.packages(&#39;devtools&#39;) devtools::install_github(&quot;gsx-ucas/QRAP&quot;, ref = &quot;dev&quot;) 1.2.2 Docker image We provide docker images for QRAP via dockerhub. To pull the latest image using the command line: # Enter commands in shell docker pull goushixue/qrap:latest 1.3 Get started 1.3.1 Launch the QRAP application in R or Rstudio library(QRAP) # loading the QRAP library to R environment startQRAP() # launch the QRAP application to web browser Then you would get the link to activate your browser: Use the link http://127.0.0.1:4986 to access the interactive analysis interface. Note that the port (4986) should change to yours. 1.3.2 Launch the QRAP application by docker image in shell docker run -p 3838:3838 goushixue/qrap # use the 3838 port Then you would get the output like this: Use the link http://localhost:3838/ to access the interactive analysis interface. 1.3.3 Access the interactive analysis interface Just start your analysis by clicking, clicking, clicking… "],["data-input-and-pre-processing.html", "Chapter 2 Data input and pre-processing 2.1 Data input 2.2 Data pre-filtering 2.3 Design table &amp; formula 2.4 Batch effect correction", " Chapter 2 Data input and pre-processing 2.1 Data input QRAP can support to analyze publicly available and user-generated data. There are two action buttons, ‘Get Started Local’ and ‘Get Started GEO’, can activate corresponding data upload and processing pipeline. 2.1.1 Upload local file For user generated local files, click the ‘Get Started Local’ button to enter the data upload page. Users need to upload a read-count matrix, in which rows represent the genes and columns represent the samples, while the contents represent the gene expression values of given sample Parameters in this section: - Choose input file: browser and upload the expression matrix file, accept .csv/.tsv/.tab/.txt format. - First row as header ? This means use the first row of the expression matrix as column names, often is samples names. - First column as rownames ? This means use the first column of the expression matrix as row names, often is gene names. After select the local files and set the parameters, click the ‘Upload’ button to preview the expression matrix. Click ‘Example’ will upload the example dataset internal, transcriptomes of SARS-Cov-2 infected normal human bronchial epithelial cells (GSE147507). 2.1.2 Pull down GEO datasets The Gene Expression Omnibus (GEO) is a public repository that archives and freely distributes comprehensive sets of microarray, next-generation sequencing, and other forms of high-throughput functional genomic data submitted by the scientific community. For GEO datasets, users need to input an accession number to query the gene expression matrix through GEOquery. After you input the GEO Acession Number and active the ‘Download matrix’ button, We will download the value matrix tables within GDSxxx or supplementary files within GSExxx, these files will store in the working directory of the R project you created. When the files download accomplished, there will show the download files name in the Parameter setting panel, and you should select file(s) that contain interested gene expression matrix and active the ‘Loading GEO’ button to preview the matrix. Please Note that if the files are in a tar archive format, such as htseq-count generated results, these files will contain Gene ID and Gene Expression Value of each sample, respectively. Therefore, you need to provid the column number of the Gene ID and Gene Expression Value to help merge the files to generate an analysis ready gene expression matrix. Step 1. Choose a single file, and leave the ‘First row as header’ and ‘First column as rownames’ unchecked, then click the button ‘Loading GEO’ to preview what the file contained. Step 2. Choose all or interested files, set the column number of geneID and readCounts, then click the button ‘Loading GEO’ to generate and preview the analysis ready expression matrix. 2.2 Data pre-filtering QRAP starts with a read-counts matrix or GEO accession number, and then filters out low expression genes under an given threshold. We then specify the organisms and filtered out low expression genes. Note the Gene Types: SYMBOL ENSEMBL ENTREZID GAPDH ENSG00000111640 2597 TP53 ENSG00000141510 7157 2.3 Design table &amp; formula A DESeqDataSet object must have an associated design formula. The design formula expresses the variables which will be used in modeling. QRAP will automatically produces an dataframe that contain sample names in the first column and condition variables in the second column. The condition column was simply generated by deleting the replicates numbers (eg. -1, -2, -3). User can download this design table by the button where the arrow indicated. If the condition variables in the second column were not produced correctly, user should adjust it manually in Microsoft Excel and save it as .csv format file. Then, user need choose the ‘Re-upload’ option where the arrow shows and re-upload the corrected design table through the file upload box. The formula should be a tilde (~) followed by the variables, and the is used to estimate the dispersions and to estimate the log2 fold changes of the model. The transformation functions can be specified as rlog (regularized logarithm) and vst (variance stabilizing transformations). 2.4 Batch effect correction If there is unwanted variation present in the data (e.g. batch effects) it is always recommend to correct for this. The batch effects can be accommodated in DESeq2 by including in the design any known batch variables, and estimated by functions ComBat in sva (Leek 2014) or removwBatchEffect in limma (Matthew et al. 2015). 1. For performing batch effect correction, the two factor variables batch and condition should be columns of the design table. 2. Setting the batch correction parameters by click “Additional Parameters …” button. Two functions were provide to perform batch correction, ComBat in sva or removwBatchEffect in limma. "],["data-quality-exploring.html", "Chapter 3 Data quality exploring 3.1 Principal component analysis (PCA) 3.2 Hierarchical clustering 3.3 Sample-to-sample distance 3.4 Sample correlation coefficient", " Chapter 3 Data quality exploring In biological experiments, it is often necessary to set up technical and biological repetition to avoid accidental variation affecting the results. RNA-seq usually sets 3-5 biological repeats, so it is necessary to confirm the quality of biological repetitions and determine that the sequencing data can truly reflect the transcriptome changes across experimental conditions. Principal components analysis (PCA), hierarchical clustering heatmap, sample to sample heatmap and sample correlation coefficient was the most used method to assess the sequencing data quality, which can identify bad sample replicates and batch effects. 3.1 Principal component analysis (PCA) Principal component analysis (PCA) is a mathematical algorithm that reduces the dimensionality of the data while retaining most of the variation in the data set1. It accomplishes this reduction by identifying directions, called principal components, along which the variation in the data is maximal. By using a few components, each sample can be represented by relatively few numbers instead of by values for thousands of variables. Samples can then be plotted, making it possible to visually assess similarities and differences between samples and determine whether samples can be grouped. As shown in the screenshot below, left panel provides the parameters to perform PCA and visualize the results, middle panel will show the visualization results, and right panel provides the control of the width and height of figure. For users with programming skills, ggplot2 codes can be added to modify the figure layer directly. Just note that do not add plus sign (+) at the beginning of the first line codes. 3.2 Hierarchical clustering Hierarchical clustering analysis is an algorithm that groups similar objects into groups called clusters. The endpoint is a set of clusters, where each cluster is distinct from each other cluster, and the objects within each cluster are broadly similar to each other. In RNA-seq, the objects can be samples or genes. HCA is often combined with heatmap to show the cluster of samples in the column and genes in the rows. The agglomeration algorithm of hierarchical clustering combines the two most similar data points (genes or samples) of all data points by calculating the similarity between the two types of data points, and iterates this process repeatedly. To put it simply, the agglomeration algorithm of hierarchical clustering is to determine the similarity between each category of data points and all data points by calculating the distance between them. The smaller the distance, the higher the similarity. And the two nearest data points or categories are combined to generate a cluster tree. To perform hierarchical clustering analysis, users should specify how many genes to used for this analysis. Typically, top 500 or 1000 most high variable genes will be used for clustering genes and samples. To change colors of the heatmap, users can enter three colors separated by comma. The colors entered will be used to generate an continuous color vector to specify the colors of heatmap. For example, to generate a heatmap colored by ‘green,black,red’. To divide the heatmap based on the hierarchical clustering, users can specify the parameters throung ‘Additional parameters …’. 3.3 Sample-to-sample distance Sample-to-sample distance (SSD) is another method to assess sequencing and sample replicates quality based on calculated distance between samples. SSDA calculated similarity between samples based on distance metrics, which specify how the distance between the input samples. A commonly used approach for measuring sample distance in RNA-seq data is to use Euclidean distance. SSD can elucidate samples distance in the high-dimensional space. In RNA-seq data, each gene is a dimension, so the data has tens of thousands of dimensions. SSD uses Euclidean distance to elucidate samples distance in the high-dimensional space, which helps to understand the relationship of samples across experimental conditions or sample replicates. The heatmap clusters samples with similar distances, which makes the results easier to interpret. 3.4 Sample correlation coefficient The correlation coefficient is a statistical measure of the strength of the relationship between the relative movements of two variables. The values range between -1.0 and 1.0. A calculated number greater than 1.0 or less than -1.0 means that there was an error in the correlation measurement. A correlation of -1.0 shows a perfect negative correlation, while a correlation of 1.0 shows a perfect positive correlation. A correlation of 0.0 shows no linear relationship between the movement of the two variables. Correlation statistics can be used in RNA-seq for assessing data quality. For example, a correlation coefficient could be calculated to determine the correlation between sample replicates, which indicate the biological replication quality of samples. Another example, a correlation coefficient between conditions, such as treatment group and WT control, could indicate the treatment effects. Three visualization methods were provided in this section, heatmap, scatterplot and pairs.penels. heatmap scatterplot pairs.penels "],["differential-expression-analysis.html", "Chapter 4 Differential expression analysis 4.1 Extract DEGs 4.2 Visualize DEGs", " Chapter 4 Differential expression analysis The most important application of RNA-seq is to detect differentially expressed genes between variance conditions or groups. Differential expression analysis (DEA) requires that gene expression values should be compared among samples. We chose the DESeq2 package to perform the expression normalization to adjust abundance quantities in order to account for differences in read depth across the samples. After that, the function ‘results’ of DESeq2 wase used for calculating the foldchange of gene expression levels and P-values across experimental and control condition. 4.1 Extract DEGs DESeq2 offers two kinds of hypothesis tests: the Wald test, where we use the estimated standard error of a log2 fold change to test if it is equal to zero, and the likelihood ratio test (LRT). The LRT examines two models for the counts, a full model with a certain number of terms and a reduced model, in which some of the terms of the full model are removed. The test determines if the increased likelihood of the data using the extra terms in the full model is more than expected if those extra terms are truly zero. 4.1.1 Wald significance tests To extract DEGs, user should specify one group as control, and one or more groups as treatment. Then, the threshold of P value and log2 fold change shold be specified as well. Most commonly used standard to define differentially expressed gene (DEG) is |log2FoldChange| &gt; 1 and P-value &lt; 0.05, but we also provide the options for user’s custom defined standard to filter DEGs. 4.1.2 Likelihood ratio test To extract DEGs by LRT, user just need to specify one group as control and one groups as treatment, cause LRT will return only one group DEGs. P-value threshold should be set no more than 0.05. Note that log2FoldChange should be set to 0. 4.2 Visualize DEGs We provide five approaches to visualize the DEGs, include volcano plot, MA-plot, bar-plot, heatmap, venn diagram. Volcano plot Heatmap Venn diagram Bar-plot The details of DEGs "],["deg-expression-pattern-detection.html", "Chapter 5 DEG expression pattern detection 5.1 One-way time coures experiment 5.2 Two-way time coures experiment", " Chapter 5 DEG expression pattern detection Research involved time series experiment would more interested in genes that differentially expressed along time points. We provide the DEGreport pacakge to distinguish different gene expression patterns of differentially expressed genes. For example, we group genes that expression increase over time into one expression pattern, and group genes that expression decrease over time into another expression pattern. These differentially expressed genes show different expression patterns over time, suggesting that they may have different biological functions and meanings. 5.1 One-way time coures experiment 5.1.1 pre-processing and preparation For the time-course experiment that only the first time point was set as the control, DEGs were detected at each time point in contrast to the first time point. The condition should be time points. Or using LRT to detect DEGs which at one or more time points after time 0. Set test method as “LRT” and reduced as “~ 1”. 5.1.2 Detect DEG expression pattern Then, the DEGreport package was employed to calculate the gene similarity among samples and cluster the genes into expression patterns. To detect the DEG expression patterns, user should specify the group of DEGs, such as dpi_2_vs_dpi_0 and dpi_4_vs_dpi_0. And user need to specify the variable with which the gene expression changes. Due to there is only one time course of the experiment, thus we leave the “variable to separate samples” to NULL. 5.1.3 Visualize DEG expression pattern User can select DEG expression pattern clusters to visualize the results, and adjust the time point order by specifing the ‘plotting order’ option. 5.2 Two-way time coures experiment 5.2.1 pre-processing and preparation For time-course experiment that sets a control at each time point, an appreciate way to detected DEGs over time is use the likelihood ratio test (LRT) with the design formula like “~ condition + time + condition:time”, and reduced formula like “~ condition + time”. set design formula as “~ condition + time + condition:time” set test method as “LRT” and reduced formula as “~ condition + time” Or detected DEGs at each time point contrast to the corresponding control in the common manner. 5.2.2 Detect DEG expression pattern Due to there would be more than one time course of the experiment, thus we set “variable that changes” to “time” and set “variable to separate samples” to “condition”. 5.2.3 Visualize DEG expression pattern User can select DEG expression pattern clusters to visualize the results, and adjust the time point order by specifing the ‘plotting order’ option. "],["weighted-correlation-network-analysis.html", "Chapter 6 weighted correlation network analysis 6.1 Data preparation 6.2 Soft threshold detection 6.3 Gene module detection 6.4 Module-Traits relationship 6.5 MM vs. GS scatterplot 6.6 Module gene expression visualization", " Chapter 6 weighted correlation network analysis We have finished a nice book. 6.1 Data preparation 6.2 Soft threshold detection 6.3 Gene module detection 6.4 Module-Traits relationship 6.5 MM vs. GS scatterplot 6.6 Module gene expression visualization "],["functional-enrichment-analysis.html", "Chapter 7 functional enrichment analysis 7.1 Gprofiler API 7.2 ClusterProfiler-ORA 7.3 ClusterProfiler-GSEA", " Chapter 7 functional enrichment analysis After the differential expression analysis and biological pattern detection (DEG patterns and WGCNA modules), functional enrichment analysis was usually used to characterize the molecular functions or pathways in which genes involved. There are two main approaches to perform the functional enrichment analysis, (i) ORA that using a list of genes of interest as input and (ii) GSEA that using all genes ranked by log2foldchange as input. We apply clusterProfiler and gprofiler2 (an R client of g:Profiler) to perform the ORA and GSEA analysis. In addition to supporting the use of Gene Ontology, KEGG, and Reactome knowledge base, gprofiler2 also support WikiPathway, miRTarBase, TRANSFAC, Human Protein Atlas, CORUM and Human Phenotype Ontology knowledge base. 7.1 Gprofiler API g:Profiler is a public web server for characterising and manipulating gene lists. The R package gprofiler2 provides an R interface to the g:Profiler tools. g:Profiler is developed and maintained in Estonia, at the University of Tartu, Institute of Computer Science, Bioinformatics, Algorithmics and Data Mining Group BIIT. Currently g:Profiler is developed and maintained by a team of professional software developers, statistician and researchers. 7.2 ClusterProfiler-ORA 7.3 ClusterProfiler-GSEA "],["gene-regulatory-network.html", "Chapter 8 Gene regulatory network 8.1 KEGG Pathview 8.2 PPI network 8.3 GENIE3 inffered network", " Chapter 8 Gene regulatory network We have finished a nice book. 8.1 KEGG Pathview 8.2 PPI network 8.3 GENIE3 inffered network "],["summary-of-genes-and-functions.html", "Chapter 9 Summary of genes and functions 9.1 summarize genes 9.2 summarize functions", " Chapter 9 Summary of genes and functions We have finished a nice book. 9.1 summarize genes 9.2 summarize functions "],["references.html", "References", " References "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
