<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Differential expression analysis | QRAP: an R package and Shiny app for interactive RNA sequencing data analysis</title>
  <meta name="description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  <meta name="generator" content="bookdown 0.30 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Differential expression analysis | QRAP: an R package and Shiny app for interactive RNA sequencing data analysis" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Differential expression analysis | QRAP: an R package and Shiny app for interactive RNA sequencing data analysis" />
  
  <meta name="twitter:description" content="This is a minimal example of using the bookdown package to write a book. The output format for this example is bookdown::gitbook." />
  

<meta name="author" content="Shixue Gou" />


<meta name="date" content="2022-12-08" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="data-quality-exploring.html"/>
<link rel="next" href="deg-expression-pattern-detection.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">A Minimal Book Example</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#introduction"><i class="fa fa-check"></i><b>1.1</b> Introduction</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#installation"><i class="fa fa-check"></i><b>1.2</b> Installation</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="intro.html"><a href="intro.html#r-package"><i class="fa fa-check"></i><b>1.2.1</b> R package</a></li>
<li class="chapter" data-level="1.2.2" data-path="intro.html"><a href="intro.html#docker-image"><i class="fa fa-check"></i><b>1.2.2</b> Docker image</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#get-started"><i class="fa fa-check"></i><b>1.3</b> Get started</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="intro.html"><a href="intro.html#launch-the-qrap-application-in-r-or-rstudio"><i class="fa fa-check"></i><b>1.3.1</b> Launch the QRAP application in R or Rstudio</a></li>
<li class="chapter" data-level="1.3.2" data-path="intro.html"><a href="intro.html#launch-the-qrap-application-by-docker-image-in-shell"><i class="fa fa-check"></i><b>1.3.2</b> Launch the QRAP application by docker image in shell</a></li>
<li class="chapter" data-level="1.3.3" data-path="intro.html"><a href="intro.html#access-the-interactive-analysis-interface"><i class="fa fa-check"></i><b>1.3.3</b> Access the interactive analysis interface</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html"><i class="fa fa-check"></i><b>2</b> Data input and pre-processing</a>
<ul>
<li class="chapter" data-level="2.1" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#data-input"><i class="fa fa-check"></i><b>2.1</b> Data input</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#upload-local-file"><i class="fa fa-check"></i><b>2.1.1</b> Upload local file</a></li>
<li class="chapter" data-level="2.1.2" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#pull-down-geo-datasets"><i class="fa fa-check"></i><b>2.1.2</b> Pull down GEO datasets</a></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#data-pre-filtering"><i class="fa fa-check"></i><b>2.2</b> Data pre-filtering</a></li>
<li class="chapter" data-level="2.3" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#design-table-formula"><i class="fa fa-check"></i><b>2.3</b> Design table &amp; formula</a></li>
<li class="chapter" data-level="2.4" data-path="data-input-and-pre-processing.html"><a href="data-input-and-pre-processing.html#batch-effect-correction"><i class="fa fa-check"></i><b>2.4</b> Batch effect correction</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="data-quality-exploring.html"><a href="data-quality-exploring.html"><i class="fa fa-check"></i><b>3</b> Data quality exploring</a>
<ul>
<li class="chapter" data-level="3.1" data-path="data-quality-exploring.html"><a href="data-quality-exploring.html#principal-component-analysis-pca"><i class="fa fa-check"></i><b>3.1</b> Principal component analysis (PCA)</a></li>
<li class="chapter" data-level="3.2" data-path="data-quality-exploring.html"><a href="data-quality-exploring.html#hierarchical-clustering"><i class="fa fa-check"></i><b>3.2</b> Hierarchical clustering</a></li>
<li class="chapter" data-level="3.3" data-path="data-quality-exploring.html"><a href="data-quality-exploring.html#sample-to-sample-distance"><i class="fa fa-check"></i><b>3.3</b> Sample-to-sample distance</a></li>
<li class="chapter" data-level="3.4" data-path="data-quality-exploring.html"><a href="data-quality-exploring.html#sample-correlation-coefficient"><i class="fa fa-check"></i><b>3.4</b> Sample correlation coefficient</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="differential-expression-analysis.html"><a href="differential-expression-analysis.html"><i class="fa fa-check"></i><b>4</b> Differential expression analysis</a>
<ul>
<li class="chapter" data-level="4.1" data-path="differential-expression-analysis.html"><a href="differential-expression-analysis.html#extract-degs"><i class="fa fa-check"></i><b>4.1</b> Extract DEGs</a></li>
<li class="chapter" data-level="4.2" data-path="differential-expression-analysis.html"><a href="differential-expression-analysis.html#visualize-degs"><i class="fa fa-check"></i><b>4.2</b> Visualize DEGs</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="deg-expression-pattern-detection.html"><a href="deg-expression-pattern-detection.html"><i class="fa fa-check"></i><b>5</b> DEG expression pattern detection</a>
<ul>
<li class="chapter" data-level="5.1" data-path="deg-expression-pattern-detection.html"><a href="deg-expression-pattern-detection.html#detect-deg-expression-pattern"><i class="fa fa-check"></i><b>5.1</b> Detect DEG expression pattern</a></li>
<li class="chapter" data-level="5.2" data-path="deg-expression-pattern-detection.html"><a href="deg-expression-pattern-detection.html#visualize-deg-expression-pattern"><i class="fa fa-check"></i><b>5.2</b> Visualize DEG expression pattern</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html"><i class="fa fa-check"></i><b>6</b> weighted correlation network analysis</a>
<ul>
<li class="chapter" data-level="6.1" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#data-preparation"><i class="fa fa-check"></i><b>6.1</b> Data preparation</a></li>
<li class="chapter" data-level="6.2" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#soft-threshold-detection"><i class="fa fa-check"></i><b>6.2</b> Soft threshold detection</a></li>
<li class="chapter" data-level="6.3" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#gene-module-detection"><i class="fa fa-check"></i><b>6.3</b> Gene module detection</a></li>
<li class="chapter" data-level="6.4" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#module-traits-relationship"><i class="fa fa-check"></i><b>6.4</b> Module-Traits relationship</a></li>
<li class="chapter" data-level="6.5" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#mm-vs.-gs-scatterplot"><i class="fa fa-check"></i><b>6.5</b> MM vs. GS scatterplot</a></li>
<li class="chapter" data-level="6.6" data-path="weighted-correlation-network-analysis.html"><a href="weighted-correlation-network-analysis.html#module-gene-expression-visualization"><i class="fa fa-check"></i><b>6.6</b> Module gene expression visualization</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="functional-enrichment-analysis.html"><a href="functional-enrichment-analysis.html"><i class="fa fa-check"></i><b>7</b> functional enrichment analysis</a>
<ul>
<li class="chapter" data-level="7.1" data-path="functional-enrichment-analysis.html"><a href="functional-enrichment-analysis.html#gprofiler-api"><i class="fa fa-check"></i><b>7.1</b> Gprofiler API</a></li>
<li class="chapter" data-level="7.2" data-path="functional-enrichment-analysis.html"><a href="functional-enrichment-analysis.html#clusterprofiler-ora"><i class="fa fa-check"></i><b>7.2</b> ClusterProfiler-ORA</a></li>
<li class="chapter" data-level="7.3" data-path="functional-enrichment-analysis.html"><a href="functional-enrichment-analysis.html#clusterprofiler-gsea"><i class="fa fa-check"></i><b>7.3</b> ClusterProfiler-GSEA</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="gene-regulatory-network.html"><a href="gene-regulatory-network.html"><i class="fa fa-check"></i><b>8</b> Gene regulatory network</a>
<ul>
<li class="chapter" data-level="8.1" data-path="gene-regulatory-network.html"><a href="gene-regulatory-network.html#kegg-pathview"><i class="fa fa-check"></i><b>8.1</b> KEGG Pathview</a></li>
<li class="chapter" data-level="8.2" data-path="gene-regulatory-network.html"><a href="gene-regulatory-network.html#ppi-network"><i class="fa fa-check"></i><b>8.2</b> PPI network</a></li>
<li class="chapter" data-level="8.3" data-path="gene-regulatory-network.html"><a href="gene-regulatory-network.html#genie3-inffered-network"><i class="fa fa-check"></i><b>8.3</b> GENIE3 inffered network</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="summary-of-genes-and-functions.html"><a href="summary-of-genes-and-functions.html"><i class="fa fa-check"></i><b>9</b> Summary of genes and functions</a>
<ul>
<li class="chapter" data-level="9.1" data-path="summary-of-genes-and-functions.html"><a href="summary-of-genes-and-functions.html#summarize-genes"><i class="fa fa-check"></i><b>9.1</b> summarize genes</a></li>
<li class="chapter" data-level="9.2" data-path="summary-of-genes-and-functions.html"><a href="summary-of-genes-and-functions.html#summarize-functions"><i class="fa fa-check"></i><b>9.2</b> summarize functions</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">QRAP: an R package and Shiny app for interactive RNA sequencing data analysis</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="differential-expression-analysis" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Differential expression analysis<a href="differential-expression-analysis.html#differential-expression-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>The most important application of RNA-seq is to detect differentially expressed genes between variance conditions or groups. Differential expression analysis (DEA) requires that gene expression values should be compared among samples. We chose the DESeq2 package to perform the expression normalization to adjust abundance quantities in order to account for differences in read depth across the samples. After that, the function ‘results’ of DESeq2 wase used for calculating the foldchange of gene expression levels and P-values across experimental and control condition.</p>
<div id="extract-degs" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Extract DEGs<a href="differential-expression-analysis.html#extract-degs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>To extract DEGs, user should specify one group as control, and one or more groups as treatment. Then, the threshold of P value and log2 fold change shold be specified as well. Most commonly used standard to define differentially expressed gene (DEG) is |log2FoldChange| &gt; 1 and P-value &lt; 0.05, but we also provide the options for user’s custom defined standard to filter DEGs.</p>
<p><img src="images/dea-de.jpeg" /></p>
</div>
<div id="visualize-degs" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Visualize DEGs<a href="differential-expression-analysis.html#visualize-degs" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We provide five approaches to visualize the DEGs, include volcano plot, MA-plot, bar-plot, heatmap, venn diagram.</p>
<ul>
<li><p>Volcano plot
<img src="images/dea-volcano.jpeg" /></p></li>
<li><p>Heatmap
<img src="images/dea-heatmap.jpeg" /></p></li>
<li><p>Venn diagram
<img src="images/dea-venn.jpeg" /></p></li>
<li><p>Bar-plot
<img src="images/dea-bar.jpeg" /></p></li>
<li><p>The details of DEGs
<img src="images/dea-tab.jpeg" /></p></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="data-quality-exploring.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="deg-expression-pattern-detection.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["QRAP_book.pdf", "QRAP_book.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
